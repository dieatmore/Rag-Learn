# RAG-检索增强生成

## 📝 OVERVIEW

RAG的学习记录：了解RAG，测试并完成一个RAG的使用。

### 🛠️ Development Tools

- spring-boot
- spring-ai
- qdrant 向量数据库

### 🤖 MODEL

选用阿里text-embedding-v4向量模型，1024维度。

<hr/>

###  ❓ Testings


1. `如何添加用户？`

   + 管理员可以通过该模块添加新用户, score: 0.8232988119125366
   + 管理员功能模块，添加用户功能, score: 0.6546160578727722
   + 管理员功能模块，更改用户权限, score: 0.5420510768890381
   + 你好，世界, score: 0.29887068271636963

> + <font size="3">管理员可以通过该模块添加新用户：文本语义与检索词完全贴合</font>
> + <font size="3">管理员功能模块，添加用户功能：语义仍关联 “添加用户”，但贴合度略低，侧重“功能”，文本冗余 / 碎片化，语义被稀释</font>
> + <font size="3">管理员功能模块，更改用户权限：核心动作偏离，但业务场景仍关联</font>
> + <font size="3">你好，世界：与检索词无任何语义关联，得分接近 0.3，仅代表 “向量空间中无意义的基础相似度”（所有文本向量与任意检索词向量都会有极低的默认相似度），无实际业务意义。</font>

2. `苹果 手机`

   + Apple手机, score: 0.8166669607162476
   + 苹果手机, score: 0.8148566484451294 
   
     > <font size="3">得分略低的原因：仅因嵌入模型对中英文品牌词编码的极细微差异（无业务层面的区别），整体仍属于 “核心匹配” 范畴。</font>
   + 苹果正品手机, score: 0.8065965175628662

     > <font size="3">"正品" 冗余修饰词稀释核心语义</font>
   + iPhone手机, score: 0.7403218746185303

     > <font size="3">语义范围缩小，“iPhone” 是苹果品牌下的具体产品系列（而非品牌本身）</font>
   + 华为手机, score: 0.6459783315658569
   + OPPO手机, score: 0.6293975710868835
   + 小米手机, score: 0.6134622097015381
   + iPhone 16 Pro Max 旗舰新品, score: 0.47404536604881287

     > <font size="3">大量冗余信息严重稀释核心语义,关键词仅占语义的一部分，冗余信息会彻底拉低匹配度（这也是 RAG 场景中 “文档越简洁，检索效果越好” 的核心原因）</font>
   + 你好，世界, score: 0.40358448028564453
   

### ✅ DETAIL

+ 三个等级比赛目录，一个等级一段（第三等级一段有五十多个比赛）
  + 1. "全国大学生软件创新大赛"
       + 第三等级score: 0.6248294115066528
       + 第二等级score: 0.594414234161377  <font size="3">（正确）</font>
       + 第一等级score: 0.5264873504638672
  + 2. "全国大学生工业设计大赛"
       + 第三等级score: 0.6173943877220154  <font size="3">（正确） </font>
       + 第二等级score: 0.5832704305648804
       + 第一等级score: 0.5033977031707764
  + 3. "蓝桥杯是什么比赛"
       + 第三等级score: 0.497569739818573 <font size="3"> （正确） </font>
       + 第二等级score: 0.47684207558631897
       + 第三等级score: 0.4593309164047241
       
<br/>     
<br/>     

+ 三个等级比赛目录，7~8个比赛一段（第三等级有8段）
  + 1. "全国大学生软件创新大赛"
       + 第二等级(某段)score: 0.6226876378059387 <font size="3"> （正确） </font>
       + 第三等级(某段)score: 0.6088396310806274
       + 第三等级(某段)score: 0.594118595123291
  + 2. "全国大学生工业设计大赛"
       + 第三等级(某段)score: 0.6241661310195923
       + 第三等级(某段)score: 0.6048571467399597
       + 第二等级(某段)score: 0.5808905959129333
       + 第三等级(某段)score: 0.5807852149009705 <font size="3"> （正确） </font>
  + 3. "蓝桥杯是什么比赛"
       + 第三等级(某段)score: 0.5459176301956177
       + 第三等级(某段)score: 0.5451034307479858 <font size="3"> （正确） </font>
       + 第三等级(某段)score: 0.5154807567596436
  + 4. "全国大学生工业设计大赛是什么比赛？"
       + 第三等级(某段)score: 0.6899532079696655
       + 第三等级(某段)score: 0.6692834496498108
       + 第三等级(某段)score: 0.650834321975708 <font size="3"> （正确） </font>
  + 5. "全国大学生工业设计大赛是第二等级的吗？"
       + 第二等级(某段)score: 0.7333270311355591
       + 第三等级(某段)score: 0.7263755202293396
       + 第二等级(某段)score: 0.7066514492034912
       + 第三等级(某段)score: 0.7004486322402954 <font size="3"> （正确） </font>
       > topK(3) --- answer: 不知道

<br/>     
<br/>

+ 三个等级比赛目录，按类分段（创新创业 | 设计 | 机器人 | 挑战 | 其它）
  + 1. "全国大学生软件创新大赛"
       + 第二等级(某段)score: 0.6230800151824951 <font size="3"> （正确） </font>
       + 第三等级(某段)score: 0.6214470863342285 <font size="3"> （创新创业类） </font>
       + 第三等级(某段)score: 0.5918700695037842 <font size="3"> （其它类） </font>
  + 2. "全国大学生工业设计大赛"
       + 第三等级(某段)score: 0.6649260520935059 <font size="3"> （正确） </font>
       + 第二等级(某段)score: 0.5833044648170471 <font size="3"> （设计类） </font>
       + 第三等级(某段)score: 0.5831056833267212 <font size="3"> （创新创业类） </font>
  + 3. "蓝桥杯是什么比赛"
       + 第三等级(某段)score: 0.5147182941436768 <font size="3"> （正确） </font>
         > <font size="3">蓝桥杯在其它类段里，由于其它类比赛信息太杂，所以相似度低</font>
       
       + 第三等级(某段)score: 0.5085140466690063 <font size="3"> （机器人类） </font>
       + 第三等级(某段)score: 0.5046647787094116 <font size="3"> （挑战类） </font>
  + 4. "全国大学生工业设计大赛是第二等级的吗？"
       + 第三等级(某段)score: 0.7437910437583923 <font size="3"> （正确） </font>
       + 第二等级(某段)score: 0.7310258150100708 <font size="3"> （设计类） </font>
       > <font size="3">错误问题引导检索</font>